<?xml version="1.0" encoding="UTF-8"?>

<project name="XXX" default="current-number">

	<property file="version.properties"/>
	<property name="build.number" value="${build.major.number}.${build.minor.number}.${build.revision.number}"/>
	<property name="src" value="${basedir}/src"/>
	<property name="dist.dir" value="${basedir}/dist"/>
	<property name="conf.dir" value="${basedir}/etc"/>
	<property name="doc.dir" value="${build.dir}/doc"/>
	<property name="test.reports.dir" value="${build.dir}/reports/"/>
	<property name="jar" value="build/jar"/>
	<property name="build" value="${basedir}/build"/>
	<property name="main-class"  value="XXX.Intro"/>
	
	<path id="compile.classpath">
		<fileset dir="lib">
			<include name="*.jar"/>
		</fileset>
	</path>
	
	<path id="test.classpath">
		<pathelement location="${build.classes.dir}"/>
		<!-- configuration -->
		<pathelement location="${conf.dir}"/>
		<fileset dir="lib">
			<include name="*.jar"/>
		</fileset>
	</path>
	
	
	<!-- Program version number -->
	<target name="current-number" description="Shows program version number in console view">
	 <echo>Software version: ${build.number}</echo>
	</target>

	<target name="major" description="the first number of program version">
	    <propertyfile  file="version.properties">
	            <entry key="build.major.number" type="int" operation="+" value="1" pattern="0"/>
	            <entry key="build.minor.number" type="int" value="0" pattern="0"/>
	            <entry key="build.revision.number" type="int" value="0" pattern="0"/>
	    </propertyfile>
	</target>
	
	<target name="minor" description="the second number of program version">
	    <propertyfile  file="version.properties">
	            <entry key="build.minor.number" type="int" operation="+" value="1" pattern="0"/>
	            <entry key="build.revision.number" type="int" value="0" pattern="0"/>
	    </propertyfile>
	</target>
	
	<target name="revision" description="the third number of program version">
	    <propertyfile  file="version.properties">
	            <entry key="build.revision.number" type="int" operation="+" value="1" pattern="0"/>
	    </propertyfile>
	</target>

	<target name="all" description="changes all software version numbers +1">
	    <propertyfile  file="version.properties">
	            <entry key="build.major.number" type="int" operation="+" value="1" pattern="0"/>
	            <entry key="build.minor.number" type="int" operation="+" value="1" pattern="0"/>
	            <entry key="build.revision.number" type="int" operation="+" value="1" pattern="0"/>
	    </propertyfile>
	</target>

	<!-- Compiling source code -->
	<target name="compile">
		<!--><antcall target="revision"></antcall><-->
		<javac srcdir="${src}"/>
	</target>
	
	<target name="run" description="executes your application via class Intro" depends="jar">
		<java fork="yes" 
			classname="src/ee/ut/math/tvt/XXX/Intro"/>
			<java jar="build/jar/XXX.jar" fork="true"/>
	</target>
	<!-->classpathref="test.classpath"<-->
	
    <target name="jar">
        <mkdir dir="build/jar"/>
        <jar destfile="build/jar/XXX.jar" basedir="build/classes">
            <manifest>
                <attribute name="Main-Class" value="${main-class}"/>
            </manifest>
        </jar>
    </target>

	
	<target name="build" description="Build the system">
		<mkdir dir="build"/>
		<mkdir dir="build/classes"/>
		<javac includeantruntime="false" 
			source="1.8" 
			target="1.8" 
			compiler="modern" 
			encoding="utf-8" 
			debuglevel="lines,vars,source" 
			debug="true" 
			destdir="build/classes" 
			srcdir="${src}">
			<classpath refid="compile.classpath"/>
		</javac>
	</target>
	
	<target name="clean" description="removing the files created during the previous build">
	   <delete dir="${build}"/>
	</target>

</project>